<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<title>ðŸ§± Lego | Predictability of a lego set deal</title>
		<link
			rel="icon"
			type="image/x-icon"
			href="./assets/images/bricked_up_logo.png"
		/>
		<link
			href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"
			rel="stylesheet"
			integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65"
			crossorigin="anonymous"
		/>
		<link
			rel="stylesheet"
			href="https://cdn-uicons.flaticon.com/2.6.0/uicons-brands/css/uicons-brands.css"
		/>
		<link
			rel="stylesheet"
			href="https://cdn-uicons.flaticon.com/2.6.0/uicons-regular-straight/css/uicons-regular-straight.css"
		/>
		<link
			rel="stylesheet"
			href="https://cdn-uicons.flaticon.com/2.6.0/uicons-solid-straight/css/uicons-solid-straight.css"
		/>
		<link
			rel="stylesheet"
			href="https://cdn-uicons.flaticon.com/2.6.0/uicons-regular-rounded/css/uicons-regular-rounded.css"
		/>
		<link rel="stylesheet" href="./assets/styles/styles.css" />
	</head>
	<header class="row align-items-center w-100 px-3 py-4">
		<div class="row align-items-center" style="width: fit-content">
			<div class="col">
				<img
					class="img-fluid"
					width="100"
					height="100"
					src="./assets/images/bricked_up_logo.png"
				/>
			</div>
			<h1 class="col-md-8">Bricked Up</h1>
		</div>
		<!-- Right-aligned dark mode toggle and countdown -->
		<div class="col d-flex flex-column align-items-end">
			<!-- Dark mode toggle -->
			<div class="form-check form-switch form-check-reverse">
				<input
					class="form-check-input align-items-center"
					type="checkbox"
					id="darkModeToggle"
				/>
				<label
					class="form-check-label"
					for="flexSwitchCheckReverse"
					style="font-size: 0.8rem"
					>Enable dark mode</label
				>
			</div>
			<!-- Countdown -->
			<div id="countdown-container" class="d-flex align-items-end flex-column">
				<p id="countdown-text">Next Data Refresh In:</p>
				<p id="countdown">
					<span id="hours">00</span>h <span id="minutes">00</span>m
					<span id="seconds">00</span>s
				</p>
			</div>
		</div>
	</header>
	<body class="px-3">
		<div id="loading-overlay">
			<img
				src="./assets/images/lego_loader_chris_gannon.gif"
				alt="Loading..."
			/>
		</div>
		<div class="row">
			<!-- Left column, with options & info about the page -->
			<div class="col-12 col-md-2" id="options-column">
				<section class="mt-2 mb-4" id="lego">
					<h2>Lego sets</h2>
					<div>
						<select
							class="form-select form-select-sm"
							id="lego-set-id-select"
						></select>
					</div>
				</section>
				<section class="mt-2 mb-4" id="options">
					<h2>Filters</h2>
					<div class="w-auto mb-2 d-inline-flex align-items-center" id="sort">
						<label for="sort-select">Sort:</label>
						<select
							class="form-select form-select-sm ms-2"
							name="sort"
							id="sort-select"
						>
							<option value="price-asc">Cheaper</option>
							<option value="price-desc">Expensive</option>
							<option value="date-desc">Recently published</option>
							<option value="date-asc">Anciently published</option>
							<option value="relevance-desc">Most Relevant</option>
						</select>
					</div>
					<div class="px-2 my-3" id="filters">
						<div class="row gap-2">
							<span class="btn btn-sm btn-outline-secondary col-md-4 filter"
								>Popular</span
							>
							<span class="btn btn-sm btn-outline-secondary col-md-4 filter"
								>Best Discount</span
							>
							<span class="btn btn-sm btn-outline-secondary col-md-4 filter"
								>Hot Deals</span
							>
						</div>
					</div>
				</section>
			</div>

			<!-- Main column, with the tabs and the deals & sales cards -->
			<div class="col-12 col-md">
				<!-- Navigation Bar -->
				<nav class="nav nav-tabs nav-justified">
					<button
						class="nav-link active"
						id="nav-deals-tab"
						data-bs-toggle="tab"
						data-bs-target="#nav-deals"
						type="button"
						role="tab"
						aria-controls="nav-deals"
						aria-selected="true"
					>
						<h2>Deals</h2>
					</button>
					<button
						class="nav-link"
						id="nav-favorites-tab"
						data-bs-toggle="tab"
						data-bs-target="#nav-favorites"
						type="button"
						role="tab"
						aria-controls="nav-favorites"
						aria-selected="true"
					>
						<h2>Favorites</h2>
					</button>
				</nav>

				<!-- Rendered items' cards -->
				<div class="row">
					<div class="pt-3 px-4 d-flex justify-content-between">
						<div class="w-auto d-inline-flex align-items-center" id="show">
							<label for="show-select">Show:</label>
							<select class="form-select form-select-sm ms-1" id="show-select">
								<option value="6">6</option>
								<option value="12">12</option>
								<option value="24">24</option>
							</select>
						</div>
						<div id="pagination-info"></div>
					</div>
					<div class="tab-content" id="nav-content">
						<!-- Deals' section -->
						<section
							class="tab-pane fade show active p-3"
							id="nav-deals"
							role="tabpanel"
							aria-labelledby="nav-deals-tab"
							tabindex="0"
						></section>

						<!-- Favorites' section -->
						<section
							class="tab-pane fade p-3"
							id="nav-favorites"
							role="tabpanel"
							aria-labelledby="nav-favorites-tab"
							tabindex="0"
						></section>
					</div>
				</div>

				<!-- Pagination -->
				<nav class="d-flex justify-content-center" aria-label="Page navigation">
					<ul class="pagination">
						<li class="page-item">
							<a class="page-link" href="#" aria-label="Previous">
								<span aria-hidden="true"
									><i class="fi fi-rr-caret-right"></i
								></span>
							</a>
						</li>
						<li class="page-item">
							<a class="page-link" href="#">1</a>
						</li>
						<li class="page-item">
							<a class="page-link" href="#">2</a>
						</li>
						<li class="page-item">
							<a class="page-link" href="#">3</a>
						</li>
						<li class="page-item">
							<a class="page-link" href="#" aria-label="Next">
								<span aria-hidden="true"
									><i class="fi fi-rr-caret-left"></i
								></span>
							</a>
						</li>
					</ul>
				</nav>
			</div>
		</div>

		<!-- Footer -->
		<footer class="bg-dark text-light py-4 mt-auto">
			<div class="container">
				<div class="row">
					<div class="col-md-6">
						<p class="small mb-0">
							&copy; 2024 Bricked Up. All Rights Reserved.
							<br />
							<em>
								This website aggregates publicly available data for
								informational purposes only. No malicious intent is associated
								with data scraping. Contact me for concerns.
							</em>
						</p>
					</div>
					<div class="col-md-6 text-md-end d-flex flex-column align-items-end">
						<ul class="list-inline">
							<li class="list-inline-item">
								<a
									href="mailto:joyce.lapilus@edu.devinci.fr"
									class="text-light"
									target="_blank"
								>
									<i class="fi fi-rr-envelope"></i>
								</a>
							</li>
							<li class="list-inline-item">
								<a
									href="https://github.com/atinyshrimp"
									class="text-light"
									target="_blank"
								>
									<i class="fi fi-brands-github"></i>
								</a>
							</li>
							<li class="list-inline-item">
								<a
									href="https://www.linkedin.com/in/joyce-lapilus"
									class="text-light"
									target="_blank"
								>
									<i class="fi fi-brands-linkedin"></i>
								</a>
							</li>
						</ul>
						<p class="small mb-0">Version 1.0 | Last Updated: December 2024</p>
					</div>
				</div>
			</div>
		</footer>

		<script
			src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"
			integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4"
			crossorigin="anonymous"
		></script>
		<script type="text/javascript" charset="UTF-8" src="utils.js"></script>
		<script type="text/javascript" charset="UTF-8" src="portfolio.js"></script>
		<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.6/dist/chart.umd.min.js"></script>
		<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation@3.1.0/dist/chartjs-plugin-annotation.min.js"></script>

		<!-- Modal -->
		<div
			class="modal fade"
			id="dealModal"
			data-bs-backdrop="static"
			data-bs-keyboard="false"
			tabindex="-1"
			aria-labelledby="dealModalLabel"
			aria-hidden="true"
		>
			<div
				class="modal-dialog modal-xl modal-dialog-centered modal-dialog-scrollable"
			>
				<div class="modal-content">
					<div class="modal-header">
						<h5 class="modal-title" id="dealModalLabel">Deal Information</h5>
						<button
							type="button"
							class="btn-close"
							data-bs-dismiss="modal"
							aria-label="Close"
						></button>
					</div>
					<div class="modal-body">
						<!-- Deal Info will be populated here -->
						<div id="modalDealInfo"></div>
						<hr />
						<h6>Top 5 Relevant Sales</h6>
						<div class="d-flex gap-2 overflow-auto" id="modalSalesInfo"></div>
						<hr />
						<h6>Sales Indicators</h6>
						<canvas
							id="salesDistributionChart"
							width="400"
							height="200"
						></canvas>
						<div id="modalIndicators"></div>
					</div>
					<div class="modal-footer align-items-center">
						<a style="font-size: 0.7rem" href="#" target="_blank"
							>See Original Offer</a
						>

						<a href="#" target="_blank">
							<button type="button" class="btn btn-secondary">
								See deal
								<i class="fi fi-rr-up-right-from-square"></i>
							</button>
						</a>
					</div>
				</div>
			</div>
		</div>
		<script>
			// Function to check if all images are loaded
			function areImagesLoaded(images) {
				return Array.from(images).every((img) => img.complete);
			}

			// Function to check readiness of specific elements
			function areElementsReady() {
				// Select the essential elements
				const cards = document.querySelectorAll(".card"); // Card elements
				const filters = document.querySelectorAll("#filters span"); // Filter elements
				const selectShow = document.querySelectorAll(
					"#lego-set-id-select option"
				);
				const cardImages = document.querySelectorAll(".card img"); // Images inside cards

				// Ensure cards and filters exist and all images are loaded
				const cardsLoaded = cards.length > 0;
				const filtersLoaded = filters.length > 0;
				const selectLoaded = selectShow.length > 0;
				const imagesLoaded = areImagesLoaded(cardImages);

				return cardsLoaded && selectLoaded && filtersLoaded && imagesLoaded;
			}

			// Polling function to wait for elements to load
			function waitForPageLoad() {
				const interval = setInterval(() => {
					if (areElementsReady()) {
						clearInterval(interval); // Stop checking
						const loadingOverlay = document.getElementById("loading-overlay");
						loadingOverlay.style.display = "none"; // Hide overlay
					}
				}, 100); // Check every 100ms
			}

			// Start waiting after DOM is fully parsed
			document.addEventListener("DOMContentLoaded", () => {
				waitForPageLoad();
			});
		</script>
	</body>
</html>
